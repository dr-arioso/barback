id: stashkit.core
name: StashKit
type: system
description: >
  The primary framework for transforming messy real-world inputs into structured,
  domain-aware entities using resolvers and skills, backed by one or more StashDexes
  and persisted in user Stashes.

traits:
  - knowledge_engine
  - resolver_host
  - skill_orchestrator
  - ontology_builder
  - stash_host
  - boosterpack_host

fields:
  responsibilities:
    - Coordinate resolvers and skills to interpret heterogeneous inputs.
    - Build and manage StashDexes as lexical and ontological references.
    - Normalize messy inputs into structured entities suitable for storage in Stashes.
    - Manage registration of skills, resolvers, StashDexes, and BoosterPacks.
    - Provide a stable, high-level API (e.g. fetch) for applications and BoosterPacks.
  key_components:
    - stashkit.resolvers
    - stashkit.skills
    - stashkit.stashdex
    - stashkit.stash
    - stashkit.boosterpacks

api:
  public_methods:
    - name: fetch
      description: >
        Invoke a resolver → skill-chain → Dex pipeline to interpret a request.
        May optionally store the result in a Stash.
      params:
        - request
        - resolver_id
        - stash
        - options
      returns: "StructuredEntity | PartialEntity"

    - name: register_skill
      description: "Register a Skill in the system-wide registry."
      params:
        - skill
      returns: "None"

    - name: register_resolver
      description: "Register a Resolver in the system-wide registry."
      params:
        - resolver
      returns: "None"

    - name: install_booster
      description: "Install a BoosterPack and register its components."
      params:
        - pack_id
      returns: "None"

    - name: get_dex
      description: "Retrieve a StashDex by identifier and optional version."
      params:
        - dex_id
        - version
      returns: "StashDex"

    - name: create_stash
      description: "Create a new Stash with the given identifier and optional metadata."
      params:
        - stash_id
        - metadata
      returns: "Stash"

  internal_methods:
    - name: _dispatch_resolver
      description: "Internal resolver selection and invocation logic."

  properties:
    - name: registry
      description: "Registry of installed skills, resolvers, StashDexes, and BoosterPacks."

  events:
    - name: on_resolver_missing
      description: "Fired when no resolver can interpret a request."
